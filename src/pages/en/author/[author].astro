---
import { getCollection } from "astro:content";
import type { AstroSeoProps } from "@astrolib/seo";
import Author from "@components/blog/Author.astro";
import BaseLayout from "@layouts/BaseLayout.astro";
import { useTranslatedPath } from "@i18n/utils";

export async function getStaticPaths() {
	const authors = await getCollection("authors");
	return authors
		.filter((entry) => entry.slug.startsWith("en/"))
		.map((entry) => ({
			params: { author: entry.slug.substring(3) }, // Remove 'en/' prefix
			props: { entry, lang: "en" },
		}));
}

const { entry, lang } = Astro.props;
const author = entry;
const translatePath = useTranslatedPath(lang);

const seo: AstroSeoProps = {
	title: author.data.name,
	description: author.data.description,
	canonical: `https://sviluppozen.it${translatePath(`/author/${author.slug.substring(3)}`)}`,
};
---

<BaseLayout seo={seo}>
	<Author author={author} />
</BaseLayout>
